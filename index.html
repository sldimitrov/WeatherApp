<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="images/tab-logo.png">
</head>
<body>
    <div id="logo-container">
        <img src="images/logo.png" id="logo">
    </div>
    <header class="info-container basic-font">
        <p id="current-temperature">16°</p>
        <section class="basic-font" id="additional-info">
            <heading id="city">London</heading>
            <p id="date">06:09 - Monday, 9 Sep ‘23</p>
        </section>
        <img src="images/Cloud.png" alt="cloud" id="cloud-img">
    </header>
    <span class="weather-tab-container blur"></span>
    <main class="weather-tab-container">
        <section class="search-bar-container blank-line">
            <input type="text" placeholder="Search Location..." spellcheck="false" id="search-text">
            <button id="search-button"><img src="images/search.png" id="searcher-img"></button>
        </section>
        <section class="weather-details-container">
            <p id="weather-details">Weather Details...</p>
        </section>
        <section class="forecast-container">
            <heading id="forecast-heading">
                <h4>THUNDERSTORM WITH LIGHT DRIZZLE</h4></heading>
            <div class="row" id="row1">
                <p class="w-characteristics">Temp max</p>
                <p id="temp-max">19°</p>
                <img src="images/hot_thernometer.png" alt="hot">
            </div>
            <div class="row" id="row2">
                <p class="w-characteristics">Temp min</p>
                <p id="temp-min">15°</p>
                <img src="images/cold_thernometer.png" alt="cold">
            </div>
            <div class="row" id="row3">
                <p class="w-characteristics">Humadity</p>
                <p id="humidity">58%</p>
                <img src="images/waterdrop.png" alt="waterdrop">
            </div>
            <div class="row" id="row4">
                <p class="w-characteristics">Cloudy</p>
                <p id="cloudy">86%</p>
                <img src="images/cloudy.png" alt="cloudy">
            </div>
            <div class="row" id="row5">
                <p class="w-characteristics">Wind</p>
                <p id="wind">5km/h</p>
                <img src="images/wind.png" alt="windy">
            </div>
        </section>
        <span class="blank-line" id="blank-container"></span>
        <heading class="weather-forecast-container">
            <h4 id="weather-details">Today's Weather Forecast...</h4>
        </heading>
        <section class="weather-container">
            <div class="line" id="line1">
                <img src="images/Snow.png" alt="snowflake" id="snowflake">
                <p class="hour-weather">09:00<br class="weather">Snow</p>
                <p class="forecast-temp">19°</p>
            </div>
        </section>
    </main>
<script>

    const apiKey = "539d9b287b9b99eee7e12081aa43f3a8";
    const apiUrl = "https://api.openweathermap.org/data/2.5/weather?units=metric&q="
    
    const searchBox = document.querySelector(".search-bar-container input");
    const searchBtn = document.querySelector(".search-bar-container button");
    const weatherIcon = document.getElementById("cloud-img");
    
    async function checkWeather(city){
        const response = await fetch(apiUrl + city + `&appid=${apiKey}`);
        var data = await response.json();
    
        console.log(data);
    
        document.getElementById("city").innerHTML = data.name;
        document.getElementById("current-temperature").innerHTML = Math.round(data.main.temp);  // + "°c"
     
        const myUnixTimestamp = data.dt; // start with a Unix timestamp
        const myDate = new Date(myUnixTimestamp * 1000); // convert timestamp to milliseconds and construct Date object
        document.getElementById("date").innerHTML = myDate;
        
        document.getElementById("forecast-heading").innerHTML = data.weather[0].description;
    
        document.getElementById("temp-max").innerHTML = Math.round(data.main.temp_max) + "°c";
        document.getElementById("temp-min").innerHTML = Math.round(data.main.temp_min) + "°c";
        document.getElementById("humidity").innerHTML = data.main.humidity + "%";
        document.getElementById("cloudy").innerHTML = data.clouds.all + "%";
        document.getElementById("wind").innerHTML = data.wind.speed + " km/h";
    
        if(data.weather[0].main == "Clouds"){
            weatherIcon.src="images/clouds.png";
        }
        else if (data.weather[0].main == "Clear"){
            weatherIcon.src = "images/clear.png";
        }
        else if(data.weather[0].main == "Rain"){
            weatherIcon.src = "images/rain.png"
        }
        else if(data.weather[0].main == "Drizzle"){
            weatherIcon.src ="images/drizzle.png";
        }
        else if(data.weather[0].main == "Mist"){
            weatherIcon.src = "images/mist.png";
        }
    }
    
    searchBtn.addEventListener("click", ()=>{
        checkWeather(searchBox.value);
    })
    
    checkWeather();
    </script>
</body>
</html>